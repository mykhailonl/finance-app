import{p as e,a as m,w as T}from"./chunk-EF7DTUVF-DUQZMWWT.js";import{B as v}from"./Button-DqqQBIgQ.js";import{T as w,N as u,a as S,P as B}from"./PageWrapper-_Ej_2-G9.js";import{P}from"./Pagination-CY8Od4ig.js";import{D as R}from"./Dropdown-DzqtkS2d.js";import{I as C}from"./Input-DN-dqtY9.js";import{u as l}from"./useSearchParamValue-DogU4Soc.js";import{x as D,D as p,q as d}from"./Avatar-pVEUiCx2.js";import{i as O,c as x}from"./IconType-D_XhrS7g.js";import{e as g,u as f,S as I}from"./useRecurringTransactions-BXNWG63e.js";import{f as c}from"./formatAmount-BKTdCLbz.js";import{u as F}from"./useModal-BE7etAkf.js";import"./people-vRaPxzR8.js";import"./PaginationButton-CR_COO4x.js";import"./useDevice-BvX5AX7L.js";import"./useAuth-CUq5kDrt.js";import"./sortTransactions-BED6ieis.js";const _=()=>{const[s,t]=l("query"),[r,a]=l("sortBy");return e.jsxs("div",{className:"flex gap-6 items-center justify-between",children:[e.jsx(C,{label:{showLabel:!1},input:{value:s,onChange:t,placeholder:"Search bills"},helperText:{showHelper:!1},showSearchIcon:!0,styles:"grow max-w-[320px]"}),e.jsx(R,{label:{showLabel:!0,labelText:"Sort By",bold:!1},value:r,onChange:a,options:D,showCaret:!0,styles:"gap-2",mobileView:!0})]})},q=s=>{const t=s%10,r=s%100;if(r>=11&&r<=13)return"th";switch(t){case 1:return"st";case 2:return"nd";case 3:return"rd";default:return"th"}},A=({transaction:s,status:t})=>{const r=t!=="upcoming"&&O[t],a=c(s.amount,!0),n=g(s),o=q(n);return e.jsxs("div",{className:"flex flex-col gap-2 md:grid grid-cols-[1fr_120px_100px] md:items-center md:gap-8 lg:px-4",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsx(w,{transaction:s,styles:"inline-flex"}),e.jsx("h4",{className:"text-preset-4-bold text-grey-900",children:s.name})]}),e.jsxs("div",{className:"flex justify-between items-center md:hidden",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("p",{className:"text-preset-5 text-green",children:["Monthly - ",n,o]}),r&&e.jsx(r,{})]}),e.jsx("p",{className:x("text-preset-4-bold text-end",t==="due"?"text-red":"text-grey-900"),children:a})]}),e.jsxs("div",{className:"hidden md:flex gap-2 items-center",children:[e.jsxs("p",{className:"text-preset-5 text-green",children:["Monthly - ",n,o]}),r&&e.jsx(r,{})]}),e.jsx("p",{className:x("hidden md:block text-preset-4-bold text-end",t==="due"?"text-red":"text-grey-900"),children:a})]})},k=(s,t)=>{const r=g(s);return r<=t?"paid":r>t&&r<=t+5?"due":"upcoming"},L=({transactions:s,currentDay:t})=>{const r=!s.length;return e.jsx("div",{className:"flex flex-col gap-6 grow",children:r?e.jsx(u,{text:"No recurring transactions found."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden md:grid grid-cols-[1fr_120px_100px] gap-8 items-center py-3 lg:px-4 text-preset-5 text-grey-500 border-b border-grey-100",children:[e.jsx("p",{children:"Bill Title"}),e.jsx("p",{children:"Due date"}),e.jsx("p",{className:"text-end",children:"Amount"})]}),e.jsx("div",{className:"flex flex-col gap-5",children:s.map((a,n)=>{const o=k(a,t);return e.jsxs(m.Fragment,{children:[e.jsx(A,{transaction:a,status:o}),n<s.length-1&&e.jsx(p,{})]},a.transaction_date)})})]})})},M=({label:s,value:t,amountOfTransactions:r})=>{const a=s==="Due soon";return e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:x("text-preset-5",a?"text-red":"text-grey-500"),children:s}),e.jsxs("p",{className:x("text-preset-5-bold",a?"text-red":"text-grey-900"),children:[r," (",t,")"]})]})},V=({list:s})=>e.jsx("div",{className:"flex flex-col gap-4",children:s.map((t,r)=>e.jsxs(m.Fragment,{children:[e.jsx(M,{label:t.label,value:t.value,amountOfTransactions:t.amountOfTransactions}),r<s.length-1&&e.jsx(p,{})]},t.label))}),E=({sortBy:s,page:t,query:r})=>{const{data:{paidRecurring:a,transactions:n,upcomingRecurring:o,dueSoon:i,totalPages:h,currentDay:j,hasNext:y,hasPrev:b}}=f({sortBy:s,page:t,query:r}),N=[{label:"Paid Bills",value:c(a.amount),amountOfTransactions:a.numberOfTransactions},{label:"Total Upcoming",value:c(o.amount),amountOfTransactions:o.numberOfTransactions},{label:"Due soon",value:c(i.amount),amountOfTransactions:i.numberOfTransactions}];return e.jsxs("div",{className:"flex flex-col gap-6 lg:flex-row grow",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:gap-6 lg:flex-col lg:min-w-[337px] lg:max-h-fit",children:[e.jsx(I,{iconName:"recurring",cardTitle:"Total Bills",mainCard:!0,cardValue:n.amount,styles:"md:gap-8 md:flex-col md:items-start md:justify-end"}),e.jsxs(d,{smallPadding:!0,styles:"md:grow",children:[e.jsx("h3",{className:"text-preset-3 text-grey-900",children:"Summary"}),e.jsx(V,{list:N})]})]}),e.jsxs(d,{largerGap:!0,styles:"grow",children:[e.jsx(_,{}),e.jsx(L,{transactions:n.transactions,currentDay:j}),e.jsx(P,{totalPages:h,hasNext:y,hasPrev:b})]})]})},ne=T(function(){const[t]=l("sortBy"),[r]=l("page"),[a]=l("query"),{openModal:n}=F(),{data:{transactions:o}}=f({sortBy:t,page:r,query:a}),i=!o.amount;return e.jsxs(S,{children:[e.jsx(B,{title:"Recurring Bills",styles:{containerStyles:"py-2"}}),i?e.jsx(u,{text:`Create your first recurring transaction to keep track of your
            subscriptions`,styles:{textStyles:"text-center"},children:e.jsx(v,{variant:"primary",onClick:()=>n({type:"transaction-add",options:{recurring:!0}}),styles:"max-w-[150px] p-4",children:"Add Transaction"})}):e.jsx(E,{sortBy:t,page:r,query:a})]})});export{ne as default};
